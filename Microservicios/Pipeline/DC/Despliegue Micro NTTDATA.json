{"source":2,"revision":64,"description":null,"createdBy":{"displayName":"Pedro Rafael Montenegro Rosales","url":"https://spsprodsbr1.vssps.visualstudio.com/Aa889e22f-eae6-484f-a998-ab1044d3720e/_apis/Identities/4bdfa5c6-27f0-420c-9f77-51e6caac560b","_links":{"avatar":{"href":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"}},"id":"4bdfa5c6-27f0-420c-9f77-51e6caac560b","uniqueName":"pedrito13_48@hotmail.com","imageUrl":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw","descriptor":"msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"},"createdOn":"2022-04-24T18:23:35.407Z","modifiedBy":{"displayName":"Pedro Rafael Montenegro Rosales","url":"https://spsprodsbr1.vssps.visualstudio.com/Aa889e22f-eae6-484f-a998-ab1044d3720e/_apis/Identities/4bdfa5c6-27f0-420c-9f77-51e6caac560b","_links":{"avatar":{"href":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"}},"id":"4bdfa5c6-27f0-420c-9f77-51e6caac560b","uniqueName":"pedrito13_48@hotmail.com","imageUrl":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw","descriptor":"msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"},"modifiedOn":"2022-04-25T06:35:42.320Z","isDeleted":false,"lastRelease":{"id":79,"name":"Release-79","artifacts":[],"_links":{},"description":"Triggered by NTTDATA-Maven-CI 20220425.11.","releaseDefinition":{"id":1,"projectReference":null,"_links":{}},"createdOn":"2022-04-25T06:41:03.500Z","createdBy":{"displayName":"Microsoft.VisualStudio.Services.TFS","url":"https://spsprodsbr1.vssps.visualstudio.com/Aa889e22f-eae6-484f-a998-ab1044d3720e/_apis/Identities/00000002-0000-8888-8000-000000000000","_links":{"avatar":{"href":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/s2s.MDAwMDAwMDItMDAwMC04ODg4LTgwMDAtMDAwMDAwMDAwMDAwQDJjODk1OTA4LTA0ZTAtNDk1Mi04OWZkLTU0YjAwNDZkNjI4OA"}},"id":"00000002-0000-8888-8000-000000000000","uniqueName":"00000002-0000-8888-8000-000000000000@2c895908-04e0-4952-89fd-54b0046d6288","imageUrl":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/s2s.MDAwMDAwMDItMDAwMC04ODg4LTgwMDAtMDAwMDAwMDAwMDAwQDJjODk1OTA4LTA0ZTAtNDk1Mi04OWZkLTU0YjAwNDZkNjI4OA","descriptor":"s2s.MDAwMDAwMDItMDAwMC04ODg4LTgwMDAtMDAwMDAwMDAwMDAwQDJjODk1OTA4LTA0ZTAtNDk1Mi04OWZkLTU0YjAwNDZkNjI4OA"}},"variables":{"System.Debug":{"value":"true"},"var_aws_access_key":{"value":null,"isSecret":true},"var_aws_secret_key":{"value":null,"isSecret":true}},"variableGroups":[],"environments":[{"id":1,"name":"Generacion Docker","rank":1,"owner":{"displayName":"Pedro Rafael Montenegro Rosales","url":"https://spsprodsbr1.vssps.visualstudio.com/Aa889e22f-eae6-484f-a998-ab1044d3720e/_apis/Identities/4bdfa5c6-27f0-420c-9f77-51e6caac560b","_links":{"avatar":{"href":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"}},"id":"4bdfa5c6-27f0-420c-9f77-51e6caac560b","uniqueName":"pedrito13_48@hotmail.com","imageUrl":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw","descriptor":"msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":1}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":2},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":3}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"agentSpecification":{"identifier":"ubuntu-20.04"},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":27,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Obtener Nombre Artefacto","refName":"nombreArtefacto","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"# Write your commands here\n\nfind $(Release.PrimaryArtifactSourceAlias) -type f -iname \"*.jar\"\n\narchivoJar=$(find $(Release.PrimaryArtifactSourceAlias) -type f -iname \"*.jar\")\nnombreArch=\"${archivoJar##*/}\"\necho \"$nombreArch\"\n\necho \"##vso[task.setvariable variable=nombreArtefacto]$nombreArch\"\n\n","workingDirectory":"","failOnStderr":"false","bashEnvValue":""}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Ver Variable","refName":"","enabled":false,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"# Write your commands here\n\necho $(nombreArtefacto)\n\n","workingDirectory":"","failOnStderr":"false","bashEnvValue":""}},{"environment":{},"taskId":"86e3367d-c1d2-40a3-ab67-abd1924ce49f","version":"2.*","name":"RegEx Match & Replace","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"PathToFile":"$(System.DefaultWorkingDirectory)/Microservicio/output/Dockerfile","RegEx":"{ARTEFACTO}","Global":"true","IgnoreCase":"false","MultiLine":"false","ValueToReplace":"$(nombreArtefacto)"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Ver Archivo","refName":"","enabled":false,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"# Write your commands here\n\ncat $(System.DefaultWorkingDirectory)/Microservicio/output/Dockerfile\n\n","workingDirectory":"","failOnStderr":"false","bashEnvValue":""}},{"environment":{},"taskId":"e28912f1-0114-4464-802a-a3a35437fd16","version":"2.*","name":"Docker-Micro","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"containerRegistry":"c2821380-cabb-4263-ad04-785eca2756c5","repository":"pedrinchi1987/nttda","command":"buildAndPush","Dockerfile":"**/Dockerfile","buildContext":"**","tags":"$(Build.BuildId)","arguments":"","addPipelineData":"true","addBaseImageData":"true","container":""}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":79,"url":"https://vsrm.dev.azure.com/pedrito1348/70d32c19-341b-4d8d-93d6-b05d2d4319d3/_apis/Release/releases/79","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{"BoardsEnvironmentType":{"$type":"System.String","$value":"unmapped"},"LinkBoardsWorkItems":{"$type":"System.String","$value":"False"}},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pedrito1348/_apis/public/Release/badge/70d32c19-341b-4d8d-93d6-b05d2d4319d3/1/1"},{"id":2,"name":"Instalar Imagen","rank":2,"owner":{"displayName":"Pedro Rafael Montenegro Rosales","url":"https://spsprodsbr1.vssps.visualstudio.com/Aa889e22f-eae6-484f-a998-ab1044d3720e/_apis/Identities/4bdfa5c6-27f0-420c-9f77-51e6caac560b","_links":{"avatar":{"href":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"}},"id":"4bdfa5c6-27f0-420c-9f77-51e6caac560b","uniqueName":"pedrito13_48@hotmail.com","imageUrl":"https://dev.azure.com/pedrito1348/_apis/GraphProfile/MemberAvatars/msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw","descriptor":"msa.YTU1ODU5YTItNGJlMS03NTBjLTkzOGUtZDg3MWQ5NjRhNzUw"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":4}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":5},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":6}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"agentSpecification":{"identifier":"ubuntu-20.04"},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":27,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Obtener Ruta Packer","refName":"rutaPacker","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"# Write your commands here\n\narchivo=$(find $(Release.PrimaryArtifactSourceAlias) -type f -iname \"*.pem\")\n\nrutaTemp=$(dirname $archivo)\necho \"$rutaTemp\"\n\necho \"##vso[task.setvariable variable=rutaPacker]$rutaTemp/\"\n\n","workingDirectory":"","failOnStderr":"false","bashEnvValue":""}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Ver Variable","refName":"","enabled":false,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"# Write your commands here\n\necho $(rutaPacker)\n","workingDirectory":"","failOnStderr":"false","bashEnvValue":""}},{"environment":{},"taskId":"86e3367d-c1d2-40a3-ab67-abd1924ce49f","version":"2.*","name":"Remplazar Rutas","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"PathToFile":"$(System.DefaultWorkingDirectory)/Microservicio/output/Packer/ubuntu.json","RegEx":"{RUTA}","Global":"true","IgnoreCase":"false","MultiLine":"false","ValueToReplace":"$(rutaPacker)"}},{"environment":{},"taskId":"86e3367d-c1d2-40a3-ab67-abd1924ce49f","version":"2.*","name":"Remplazar Variables TagDocker","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"PathToFile":"$(System.DefaultWorkingDirectory)/Microservicio/output/Packer/Scripts/deploy_img_docker.sh","RegEx":"{BUILD_ID}","Global":"true","IgnoreCase":"false","MultiLine":"false","ValueToReplace":"$(Build.BuildId)"}},{"environment":{},"taskId":"86e3367d-c1d2-40a3-ab67-abd1924ce49f","version":"2.*","name":"Remplazar Variables Port","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"PathToFile":"$(System.DefaultWorkingDirectory)/Microservicio/output/Packer/Scripts/deploy_img_docker.sh","RegEx":"{PORT_MQ}","Global":"true","IgnoreCase":"false","MultiLine":"false","ValueToReplace":"5000"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Ver archivos","refName":"","enabled":false,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"# Write your commands here\n\ncat $(System.DefaultWorkingDirectory)/Microservicio/output/Packer/ubuntu.json\n\necho \"-------------------------------------------------------------------------\"\n\ncat $(System.DefaultWorkingDirectory)/Microservicio/output/Packer/Scripts/deploy_img_docker.sh\n\necho \"-------------------------------------------------------------------------\"\n\necho \"-------------------------------------------------------------------------\"","workingDirectory":"","failOnStderr":"false","bashEnvValue":""}},{"environment":{},"taskId":"b3c6bb07-1292-44e7-9ec9-b211fc98b6d2","version":"1.*","name":"Packer validate","refName":"","enabled":true,"alwaysRun":false,"continueOnError":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectedServiceType":"aws","connectedServiceAzure":"","connectedServiceAWS":"fa301edd-9efc-4a7a-9bcf-4dbb849ae04b","templatePath":"$(System.DefaultWorkingDirectory)/Microservicio/output/Packer/ubuntu.json","command":"validate","force":"false","variables":"aws_access_key=$(var_aws_access_key)\naws_secret_key=$(var_aws_secret_key)","variables-file":"","options":""}},{"environment":{},"taskId":"b3c6bb07-1292-44e7-9ec9-b211fc98b6d2","version":"1.*","name":"Packer Build","refName":"","enabled":true,"alwaysRun":false,"continueOnError":true,"timeoutInMinutes":2,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectedServiceType":"aws","connectedServiceAzure":"","connectedServiceAWS":"fa301edd-9efc-4a7a-9bcf-4dbb849ae04b","templatePath":"$(System.DefaultWorkingDirectory)/Microservicio/output/Packer/ubuntu.json","command":"build","force":"false","variables":"aws_access_key=$(var_aws_access_key)\naws_secret_key=$(var_aws_secret_key)","variables-file":"","options":""}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"Generacion Docker","conditionType":2,"value":"4"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":79,"url":"https://vsrm.dev.azure.com/pedrito1348/70d32c19-341b-4d8d-93d6-b05d2d4319d3/_apis/Release/releases/79","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{"BoardsEnvironmentType":{"$type":"System.String","$value":"unmapped"},"LinkBoardsWorkItems":{"$type":"System.String","$value":"False"}},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pedrito1348/_apis/public/Release/badge/70d32c19-341b-4d8d-93d6-b05d2d4319d3/1/2"}],"artifacts":[{"sourceId":"70d32c19-341b-4d8d-93d6-b05d2d4319d3:9","type":"Build","alias":"Microservicio","definitionReference":{"artifactSourceDefinitionUrl":{"id":"https://dev.azure.com/pedrito1348/_permalink/_build/index?collectionId=e95c9ea6-1710-4e95-8c42-469d0d43acc3&projectId=70d32c19-341b-4d8d-93d6-b05d2d4319d3&definitionId=9","name":""},"defaultVersionBranch":{"id":"","name":""},"defaultVersionSpecific":{"id":"","name":""},"defaultVersionTags":{"id":"","name":""},"defaultVersionType":{"id":"latestType","name":"Latest"},"definition":{"id":"9","name":"NTTDATA-Maven-CI"},"definitions":{"id":"","name":""},"IsMultiDefinitionType":{"id":"False","name":"False"},"project":{"id":"70d32c19-341b-4d8d-93d6-b05d2d4319d3","name":"NTTDATA"},"repository":{"id":"","name":""}},"isPrimary":true,"isRetained":false}],"triggers":[{"artifactAlias":"Microservicio","triggerConditions":[{"sourceBranch":"*","tags":[],"tagFilter":null,"useBuildDefinitionBranch":false,"createReleaseOnBuildTagging":false}],"triggerType":1}],"releaseNameFormat":"Release-$(rev:r)","tags":[],"properties":{"DefinitionCreationSource":{"$type":"System.String","$value":"ReleaseNew"},"IntegrateBoardsWorkItems":{"$type":"System.String","$value":"False"},"IntegrateJiraWorkItems":{"$type":"System.String","$value":"false"}},"id":1,"name":"Despliegue Micro NTTDATA","path":"\\NTTDATA","projectReference":null,"url":"https://vsrm.dev.azure.com/pedrito1348/70d32c19-341b-4d8d-93d6-b05d2d4319d3/_apis/Release/definitions/1","_links":{"self":{"href":"https://vsrm.dev.azure.com/pedrito1348/70d32c19-341b-4d8d-93d6-b05d2d4319d3/_apis/Release/definitions/1"},"web":{"href":"https://dev.azure.com/pedrito1348/70d32c19-341b-4d8d-93d6-b05d2d4319d3/_release?definitionId=1"}}}